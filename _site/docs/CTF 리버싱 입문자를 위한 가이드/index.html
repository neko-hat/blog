<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/blog/assets/css/just-the-docs-default.css"> <script src="/blog/assets/js/vendor/lunr.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script src="/blog/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/blog/favicon.ico" type="image/x-icon"><title>CTF 리버싱 입문자를 위한 가이드 | neko_hat’s blog</title><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="CTF 리버싱 입문자를 위한 가이드" /><meta property="og:locale" content="ko" /><meta name="description" content="A Jekyll theme for documentation" /><meta property="og:description" content="A Jekyll theme for documentation" /><link rel="canonical" href="http://localhost:4000/blog/docs/CTF%20%EB%A6%AC%EB%B2%84%EC%8B%B1%20%EC%9E%85%EB%AC%B8%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EA%B0%80%EC%9D%B4%EB%93%9C/" /><meta property="og:url" content="http://localhost:4000/blog/docs/CTF%20%EB%A6%AC%EB%B2%84%EC%8B%B1%20%EC%9E%85%EB%AC%B8%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EA%B0%80%EC%9D%B4%EB%93%9C/" /><meta property="og:site_name" content="neko_hat’s blog" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CTF 리버싱 입문자를 위한 가이드" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A Jekyll theme for documentation","headline":"CTF 리버싱 입문자를 위한 가이드","url":"http://localhost:4000/blog/docs/CTF%20%EB%A6%AC%EB%B2%84%EC%8B%B1%20%EC%9E%85%EB%AC%B8%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EA%B0%80%EC%9D%B4%EB%93%9C/"}</script><body> <a class="skip-to-main" href="#main-content" style="color:aliceblue">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><style> .side-bar-profile img { margin-right: 10px; /* 이미지 오른쪽 간격 */ width: 50px; height: 50px; border-radius: 50%; } .side-bar-profile { display: flex; align-items: center; /* 세로 중앙 정렬 */ }</style><div class="side-bar"><div class="site-header"> <a href="/blog/" class="site-title lh-tight"> neko_hat's blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><div class="side-bar-profile"> <img class="neko_hat" src="/assets/images/neko_hat.png" /><p>Reverser & Pwner</p></div><ul class="nav-list"><li class="nav-list-item"><a href="/blog/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in CTF Write-ups category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/ctf-write-ups" class="nav-list-link">CTF Write-ups</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in irisCTF 2023 category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/ctf-write-ups/irisCTF2023" class="nav-list-link">irisCTF 2023</a><ul class="nav-list"><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/irisCTF%202023/ko/baby_baby_rev%20/" class="nav-list-link">baby_baby_rev</a><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/irisCTF%202023/ko/meaning%20of%20python%201/" class="nav-list-link">meaning of python 1</a><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/irisCTF%202023/ko/meaning%20of%20python%202/" class="nav-list-link">meaning of python 2</a><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/irisCTF%202023/ko/alien%20math/" class="nav-list-link">alien math</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in SECCON 2022 category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/ctf-write-ups/SECCON%202022" class="nav-list-link">SECCON 2022</a><ul class="nav-list"><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/SECCON%202022/ko/babycmp/" class="nav-list-link">babycmp</a><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/SECCON%202022/ko/find-flag/" class="nav-list-link">find-flag</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Cyber Apocalypse 2023 - The Cursed Mission category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/ctf-write-ups/Cyber%20Apocalypse%202023%20-%20The%20Cursed%20Mission" class="nav-list-link">Cyber Apocalypse 2023 - The Cursed Mission</a><ul class="nav-list"><li class="nav-list-item "> <a href="/blog/docs/CTF%20Write-ups/Cyber%20Apocalypse%202023%20-%20The%20Cursed%20Mission/ko/control_room/" class="nav-list-link">control_room</a></ul></ul><li class="nav-list-item active"><a href="/blog/docs/CTF%20%EB%A6%AC%EB%B2%84%EC%8B%B1%20%EC%9E%85%EB%AC%B8%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EA%B0%80%EC%9D%B4%EB%93%9C/" class="nav-list-link active">CTF 리버싱 입문자를 위한 가이드</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Reversing category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/Reversing" class="nav-list-link">Reversing</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Abexcm category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/Reversing/Abexcm" class="nav-list-link">Abexcm</a><ul class="nav-list"><li class="nav-list-item "> <a href="/blog/docs/reversing/Abexcm/Abexcm01/" class="nav-list-link">Abexcm01</a><li class="nav-list-item "> <a href="/blog/docs/reversing/Abexcm/Abexcm02/" class="nav-list-link">Abexcm02</a><li class="nav-list-item "> <a href="/blog/docs/reversing/Abexcm/Abexcm03/" class="nav-list-link">Abexcm03</a><li class="nav-list-item "> <a href="/blog/docs/reversing/Abexcm/Abexcm04/" class="nav-list-link">Abexcm04</a><li class="nav-list-item "> <a href="/blog/docs/reversing/Abexcm/Abexcm05/" class="nav-list-link">Abexcm05</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in CodeEngn category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/blog/docs/Reversing/CodeEngn" class="nav-list-link">CodeEngn</a><ul class="nav-list"><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2002/" class="nav-list-link">Basic RCE 02</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2003/" class="nav-list-link">Basic RCE 03</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2004/" class="nav-list-link">Basic RCE 04</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2005/" class="nav-list-link">Basic RCE 05</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2007/" class="nav-list-link">Basic RCE 07</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2008/" class="nav-list-link">Basic RCE 08</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2009/" class="nav-list-link">Basic RCE 09</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2010/" class="nav-list-link">Basic RCE 10</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2011/" class="nav-list-link">Basic RCE 11</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2012/" class="nav-list-link">Basic RCE 12</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2013/" class="nav-list-link">Basic RCE 13</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2014/" class="nav-list-link">Basic RCE 14</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2015/" class="nav-list-link">Basic RCE 15</a><li class="nav-list-item "> <a href="/blog/docs/reversing/CodeEngn/ko/Basic%20RCE%2016/" class="nav-list-link">Basic RCE 16</a></ul></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search neko_hat's blog" aria-label="Search neko_hat's blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/neko-hat/neko-hat.github.io" class="site-button" > neko_hat on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><div id="main-content" class="main-content" role="main"><style> .tag_container { display: flex; justify-content: space-between; /* 수평 정렬 */ align-items: center; /* 수직 정렬 */ } .tag_name { display: flex; align-items: center; } .tag_container h2 { font-size: 24px; font-weight: bold; color: #c2bfbf; margin-right: 10px; margin-top: 0%; } .tag { display: inline-block; padding: 4px 8px; border-radius: 20px; background-color: #007bff; color: #fff; margin-left: 5px; /* tag 간격 조정 */ } .tag:first-child { margin-left: 0; } .tag:last-child { margin-right: 0; } .language-switcher-container { display: flex; gap: 10px; } a.language-switcher { display: flex; justify-content: center; align-items: center; padding: 10px; border: none; background-color: #444; color: #fff; text-decoration: none; border-radius: 50%; width: 50px; height: 50px; line-height: 1; margin-right: 10px; } a.language-switcher:hover { background-color: #666; } a.language-switcher:active { background-color: #333; } .profiles { display: flex; align-items: center; justify-content: space-between; } .about_h2_container h2 { font-size: 24px; margin-top: 0%; font-weight: bold; color: #c2bfbf; } .about-profile { display: flex; align-items: center; } .about-profile img { margin-right: 10px; width: 70px; height: 70px; border-radius: 50%; } .profile-info { display: flex; align-items: center; justify-content: flex-end; flex-grow: 1; } .profile-info p:first-child { margin-right: 10px; } .profile-info p:last-child { font-style: italic; }</style><div class="container"><div class="row"><div class="col-lg-8 col-md-10 mx-auto"><hr><div class="tag_container"><div class="aline_tag"><h2> TAG</h2></div><div class="tag_name"> <span class="tag">reversing</span> <span class="tag">Study</span> <span class="tag">Guide</span></div></div><hr><h1 id="ctf-리버싱-입문자를-위한-가이드"> <a href="#ctf-리버싱-입문자를-위한-가이드" class="anchor-heading" aria-labelledby="ctf-리버싱-입문자를-위한-가이드"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CTF 리버싱 입문자를 위한 가이드</h1><h1 id="0-들어가기에-앞서"> <a href="#0-들어가기에-앞서" class="anchor-heading" aria-labelledby="0-들어가기에-앞서"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 0. 들어가기에 앞서…</h1><h2 id="0-0-제작한-이유"> <a href="#0-0-제작한-이유" class="anchor-heading" aria-labelledby="0-0-제작한-이유"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 0-0. 제작한 이유</h2><p>제작한 이유는 간단하다. 내가 리버싱을 처음 시작했을 때는, 어느 한 책에서 리버스 엔지니어링 파트를 보고 시작을 했다. 본격적으로 공부를 시작했지만, 혼자 공부를 하면서 여러 어려움들을 겪었고, 직접 부딪혀 가며 습득했던 노하우, 그리고 공부방법을 내가 겪었던 어려움들을 조금이나마 덜어주기 위해 제작하게 되었다.</p><p>물론 나는 아직 공부를 진행하는 일게 학생일 뿐이며, 나보다 우수한 사람은 너무나 많기 때문에, 내가 작성한 이 가이드는 참고용으로 써주길 바란다.</p><h2 id="0-1-리버싱의-본질"> <a href="#0-1-리버싱의-본질" class="anchor-heading" aria-labelledby="0-1-리버싱의-본질"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 0-1. 리버싱의 본질?</h2><p>내가 생각하는 리버싱의 본질에 대해 설명하기 전에, 보통 CTF 리버싱 문제는 주로 완성된 프로그램(binary) 형태로 주어진다. 따라서 앞으로 내가 리버싱이라 일컷고, 설명할 것은 Binary 리버싱에 대한 것임을 참고 바란다.</p><p>(현재로선) 모든 프로그램(Binary)는 사람(프로그래머)가 만든다. 또한, 프로그램의 특성상, 어떤 목적에 의해 만들어 진 것이며, 프로그래머는 그 목적에 맞게 프로그래밍을 하게 된다. 프로그래머 또한 사람이다. 목적에 맞게 프로그램을 만드는 과정에서, 제작자는 스스로의 의도를 코드로 작성하게 된다. Binary Reversing을 진행을 하면, 리버서는 제작자의 의도를 읽고, 분석하고, 파악하게 된다.</p><p>이때, 더 나아가 리버서는 자신의 의도를 덧 씌울 수 있는 정도로 분석을 진행 할수 있게 된다.</p><p>따라서 내가 생각하는 리버싱(Binary Reversing)의 본질이란, <code class="language-plaintext highlighter-rouge">제작자(프로그래머)의 의도를 분석하는 것을 넘어, 자신의 의지를 덧 씌우는 것</code>이라 생각한다</p><h2 id="0-2-필요-배경지식"> <a href="#0-2-필요-배경지식" class="anchor-heading" aria-labelledby="0-2-필요-배경지식"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 0-2. 필요 배경지식.</h2><h3 id="필수-배경지식"> <a href="#필수-배경지식" class="anchor-heading" aria-labelledby="필수-배경지식"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 필수 배경지식</h3><ol><li><code class="language-plaintext highlighter-rouge">어셈블리어</code><li>C언어<li>메모리 구조<li>함수 호출 규약</ol><h3 id="추가-배경지식"> <a href="#추가-배경지식" class="anchor-heading" aria-labelledby="추가-배경지식"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 추가 배경지식</h3><ol><li>알고리즘<li>자료구조</ol><p>이중, C언어는 기본적으로 알고 있다는 전제하에, 글이 작성되었음을 밝힌다. 어셈블리어는 아래에서 설명을 할 것이다.</p><h1 id="챕터-0-리버싱리버스-엔지니어링이란"> <a href="#챕터-0-리버싱리버스-엔지니어링이란" class="anchor-heading" aria-labelledby="챕터-0-리버싱리버스-엔지니어링이란"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 챕터 0. 리버싱(리버스 엔지니어링)이란</h1><p>리버스 엔지니어링(Reverse Engineering)은 직역하면 역공학으로, 소프트웨어를 다루는 사람들에겐 완성된 프로그램(바이너리)를 분석하는 것으로 알려져 있다.</p><p>하지만, 역공학은 엄밀히 말하면 소프트웨어에 한정된 것이 아니다. 장치 혹은 시스템의 기술적인 원리를 구조분석하을 통해 발견하는 과정 그 자체를 말한다. 즉 기계 장치, 전자 부품 그리고 소프트웨어를 조각내서 분석하는 것을 포함하며, 유지 보수를 위해 같은 기능을 하는 새 장치를 기존의 것을 사용하지 않고 만들기 위해 세부적인 작동을 분석하는 것도 포함한다.</p><p>우리가 흔히 보는 <strong><code class="language-plaintext highlighter-rouge">Logitech Crayon같은 제품의 경우도, reverse engineering으로 탄생했다고 볼 수 있을 것이며, 프로그램의 crack버전도 reverse engineering</code>을 통해 탄생한 것들이다.</strong></p><p>하지만 우리는 CTF를 위해 리버싱을 입문하는 만큼(앞서 말했듯), 이 문서에선 Binary Reversing을 다룰 것이다. (기본적인 C언어는 안다는 가정하에 진행하니 참고하자.)</p><h1 id="챕터-1-리버싱-입문하기"> <a href="#챕터-1-리버싱-입문하기" class="anchor-heading" aria-labelledby="챕터-1-리버싱-입문하기"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 챕터 1. 리버싱 입문하기.</h1><h2 id="1-0-리버싱-공부방법"> <a href="#1-0-리버싱-공부방법" class="anchor-heading" aria-labelledby="1-0-리버싱-공부방법"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-0 리버싱 공부방법</h2><p>리버싱은 사고력, 분석력 싸움이다. 따라서 <code class="language-plaintext highlighter-rouge">리버싱을 배울때 사고력과 분석력을 기르는 방향으로 공부를 진헹 하여야 한다.</code></p><p>즉, 단순 문제 해결에만 치중하면 안되며, 결국에 리버싱의 본질에 보다 다가가기 위해서는, Binary(machine code)를 우리가 읽을 수 있는 언어로 바꾸는 과정들을 꾸준히 연습해야 한다.</p><p>리버싱 solve 방법은 여러가지가 있다. Brute Force, Patch 등이 있겠지만, 리버싱 공부는 저 두가지 방법 보단, <code class="language-plaintext highlighter-rouge">분석을 통한 소스 코드 복원</code>이 주가 되어야 할 것이다.</p><p><code class="language-plaintext highlighter-rouge">그리고, 끈기가 가장 중요하다.</code> 남의 의도(생각)을 읽고 분석하는 과정인 만큼, 쉽지 않음을 명심하고 포기하지 말고 의도를 정복할 때까지 진행하겠다는 마음가짐이 필요하다.</p><p>이 두가지를 명심한다면, 여러분도 리버싱을 쉽게 진행할 수 있게 될 것이다.</p><h2 id="1-1-어셈블리어란"> <a href="#1-1-어셈블리어란" class="anchor-heading" aria-labelledby="1-1-어셈블리어란"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-1 어셈블리어란</h2><p>모두가 알고있듯, 컴퓨터는 전기로 작동되기 때문에, 0, 1의 이진수로만 작동한다.</p><p><code class="language-plaintext highlighter-rouge">컴퓨터의 두뇌인 CPU</code>에서는, 우리가 요하는 각종 연산 등을 0, 1로만 처리해야만 한다.</p><p>따라서 CPU 제조사에서는, CPU가 다른 장치에게 명령들을 내리고, 연산을 하기 위해, 이진수로 이루어진 신호체계(명령 체계)를 만들어 CPU에 탑제하여 제공하게 되며, 메뉴얼과 함께 제공을 한다.</p><p>이를 명령어 집합(Instruction set Architecture (ISA))라고 부르며, 이는 CPU 구조(CPU Architecture)별로 상이하다. 여기에는 각종 명령 뿐 아니라, 현재 시스템의 상태가 어떻게 구성되어 있는지, 명령어들이 실행될 때 그 상태가 어떻게 바뀌는지에 대해서도 정의되어있다.</p><p>ISA의 이진 명령어들은, 기계어(machine code)라고도 부르며, opcode(명령의 종류), operand(opcde의 피연산자)로 구성되어 있다,</p><p>하지만, ISA로 직접 복잡한 프로그램을 구성하기에는 너무 힘들기 때문에, 기계어와 1대1 대응되는 High Level Language가 존재하며, 이를 <code class="language-plaintext highlighter-rouge">어셈블리어(Assembly)</code>라고 한다.</p><p>길게 설영했지만, 요약하면 <code class="language-plaintext highlighter-rouge">어셈블리어(Assembly)는, 해당 CPU의 명령셋에 1대1로 대응되는 프로그래밍 언어이다.</code></p><h2 id="1-2-80x86-어셈블리어"> <a href="#1-2-80x86-어셈블리어" class="anchor-heading" aria-labelledby="1-2-80x86-어셈블리어"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-2 80x86 어셈블리어</h2><p>대부분의 PC는 현재 Intel사, AMD사의 CPU를 사용한다.</p><p>intel사와, AMD사의 CPU는 CISC ISA를 사용하고 있고, ARM Architecture를 사용하는 CPU들은 RISC ISA를 사용하고 있는데, 이를 간단하게 설명하자면, CISC ISA의 특징은 다양하고 복잡하고, 가변적으로 사용할 수 있는 명령어로 이루어져 있다는 것이며(그나마 인간에게 편함), RISC ISA는 일정한 명령어 길이, 메모리(RAM)보다는 Register사용 등의 특징이 있는데, 이 때문에 RISC ISA로 프로그램을 만드는 것은 CISC ISA 보다 힘들었다. (명령어 길이가 제한적), 따라서 프로그래머들은 CISC ISA를 선호하게 되었고, 이에 intel사의 CPU를 사용한 PC의 보급률이 높아졌다.</p><p>intel사의 Architecture인 x86이 처음 나온 프로세서는 8086프로세서(1978년)안데, 그 뒤로부터 해당 Architecture를 차용한 프로세서 시리즈들이, 80으로 시작해서 86으로 끝났기 때문에, 80x86으로 부르게 되었다.</p><p>x86 Architecture는 32bit 기반이며, AMD사에서 64bit 확장을 처음 했기 때문에, amd64로 64bit Architecture가 존재하게 되었다.</p><p>해당 장에서는, x86, amd64 Assembly를 혼용하여 설명할 것임을 밝힌다.</p><p>Assembly에서 중요하게 알아야 할 것은, <code class="language-plaintext highlighter-rouge">함수의 호출 규약과, 피연산자로 쓰이는 레지스터(Register)</code>들의 역할이다. (32bit, 64bit 프로세서를 나누는 기준이 되는 것이 Register가 한번에 처리할 수 있는 최대 bit이다.)</p><h3 id="x86-register"> <a href="#x86-register" class="anchor-heading" aria-labelledby="x86-register"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> x86 Register</h3><p><img src="/assets/images/guide-for-reversing-image/Untitled.png" alt="image" /></p><p><strong><code class="language-plaintext highlighter-rouge">[Image - x86 Register]</code></strong></p><p><img src="/assets/images/guide-for-reversing-image/Untitled%201.png" alt="image" /></p><p><strong><code class="language-plaintext highlighter-rouge">[Image - x86 General Register Detail]</code></strong></p><p><img src="/assets/images/guide-for-reversing-image/Untitled%202.png" alt="image" /></p><p><strong><code class="language-plaintext highlighter-rouge">[Image - x86 Segment Register Detail]</code></strong></p><p>정리한 x86 Register의 역할과 명칭들이다. 64bit는 해당 32bit Register의 확장형 이므로 따로 정리하진 않겠다,</p><h3 id="assembly-hello-world로-이해하기"> <a href="#assembly-hello-world로-이해하기" class="anchor-heading" aria-labelledby="assembly-hello-world로-이해하기"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Assembly Hello World로 이해하기</h3><div class="language-nasm highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">section</span> <span class="nv">.data</span>
	<span class="nf">welcome</span> <span class="nv">db</span> <span class="s">"Hello, World!"</span>

<span class="nf">section</span> <span class="nv">.text</span>
	<span class="nf">global</span> <span class="nv">_start</span>

<span class="nl">_start:</span>
	<span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mh">0x4</span><span class="c1">; write</span>
	<span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mi">1</span><span class="c1">; stdout</span>
	<span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">welcome</span><span class="c1">; buf</span>
	<span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mh">0xd</span><span class="c1">; message length	</span>
	<span class="nf">int</span> <span class="mh">0x80</span><span class="c1">; call write</span>

	<span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mh">0x1</span><span class="c1">; exit</span>
	<span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mh">0x0</span><span class="c1">; error code</span>
	<span class="nf">int</span> <span class="mh">0x80</span><span class="c1">; call exit</span>
</code></pre></div></div><p><strong><code class="language-plaintext highlighter-rouge">[Code - HelloWorld_32bit.s]</code></strong></p><div class="language-nasm highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">section</span> <span class="nv">.data</span>
	<span class="nf">welcome</span> <span class="nv">db</span> <span class="s">"Hello, Wolrd!"</span>

<span class="nf">section</span> <span class="nv">.text</span>
	<span class="nf">global</span> <span class="nv">_start</span>

<span class="nl">_start:</span>
	<span class="nf">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="mi">1</span><span class="c1">; sys_write</span>
	<span class="nf">mov</span> <span class="nb">rdi</span><span class="p">,</span> <span class="mi">1</span><span class="c1">; stdout</span>
	<span class="nf">mov</span> <span class="nb">rsi</span><span class="p">,</span> <span class="nv">welcome</span><span class="c1">; buf</span>
	<span class="nf">mov</span> <span class="nb">rdx</span><span class="p">,</span> <span class="mh">0xd</span><span class="c1">; message length</span>
	<span class="nf">syscall</span><span class="c1">; calling sys_write</span>
	
	<span class="nf">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="mh">0x3c</span><span class="c1">; sys_exit</span>
	<span class="nf">mov</span> <span class="nb">rdi</span><span class="p">,</span> <span class="mh">0x0</span><span class="c1">; error_code</span>
	<span class="nf">syscall</span><span class="c1">; calling sys_exit with error_code</span>
</code></pre></div></div><p><strong><code class="language-plaintext highlighter-rouge">[Code - HelloWorld_64bit.s]</code></strong></p><p>위의 두 코드는 위에서부터, x86 Architecture, amd64 Architecture로 작성된 Hello,World 출력 프로그램이다.</p><p>Assembly에도 여러 문법이 존재하는데, x86기반의 Assembly의 경우, 대표적으로 AT&amp;T문법과, intel문법이 존재한다.(위의 코드는 intel 문법으로 작성되었으며, intel 문법 기반으로 문서는 작성한다.)</p><div class="language-nasm highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">.data</span>
<span class="nl">welcome:</span>
    <span class="nf">.string</span> <span class="s">"Hello world!"</span>

<span class="nf">.text</span>
<span class="nf">.globl</span> <span class="nv">_start</span>
<span class="nl">_start:</span>
    <span class="nf">movl</span> <span class="kc">$</span><span class="mi">4</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
    <span class="nf">movl</span> <span class="kc">$</span><span class="mi">1</span><span class="p">,</span> <span class="o">%</span><span class="nb">ebx</span>
    <span class="nf">movl</span> <span class="kc">$</span><span class="nv">welcome</span><span class="p">,</span> <span class="o">%</span><span class="nb">ecx</span>
    <span class="nf">movl</span> <span class="kc">$</span><span class="mh">0xd</span><span class="p">,</span> <span class="o">%</span><span class="nb">edx</span>
    <span class="nf">int</span>  <span class="kc">$</span><span class="mh">0x80</span>

    <span class="nf">movl</span> <span class="kc">$</span><span class="mi">1</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
    <span class="nf">movl</span> <span class="kc">$</span><span class="mi">0</span><span class="p">,</span> <span class="o">%</span><span class="nb">ebx</span>
    <span class="nf">int</span>  <span class="kc">$</span><span class="mh">0x80</span>
</code></pre></div></div><p><strong><code class="language-plaintext highlighter-rouge">[Code - x86_AT&amp;T Grammer Hello World]</code></strong>(AT&amp;T 문법 코드 예제)**</p><p>intel 문법의 경우 요약하면 다음처럼 해석된다.(AT&amp;T 문법은 반대로 해석)</p><p><code class="language-plaintext highlighter-rouge">opcode operand1(, operand2)</code> → operand1에 opcode를 적용한다, operand1, operand2에 opcode를 적용한다.(적용한 결과를 operand1에 저장한다.)</p><p>앞서, Assembly는 opcode와 operand로 이루어진다고 했다싶이, _start 프로시저에서 첫번째 라인인 <code class="language-plaintext highlighter-rouge">mov eax, 0x4; write</code>를 볼 경우, opcode는 <code class="language-plaintext highlighter-rouge">mov</code>operand는 <code class="language-plaintext highlighter-rouge">eax와 0x4</code>이다.</p><p>위처럼 해석을 하면, 이는 <code class="language-plaintext highlighter-rouge">EAX에 0x4를 mov(저장)해라.</code>라는 의미로 해석되는 것이다.</p><h3 id="기초-opcode"> <a href="#기초-opcode" class="anchor-heading" aria-labelledby="기초-opcode"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 기초 Opcode</h3><div class="table-wrapper"><table><thead><tr><th>Opcode<th>문법<th>의미<tbody><tr><td>call<td>call OPERAND<td>함수 호출<tr><td>ret<td>ret<td>호출된 함수 종료, 호출된 다음 명령줄로 이동(return)<tr><td>nop<td>nop                           <td>아무것도 하지 않음<tr><td>cmp<td>cmp OPERAND1, OPERAND2  <td>OPERAND1, OPERAND2을 값의 차로 비교. <br />결과값 저장됨. <br />값이 같으면 ZF 1로 세팅<tr><td>test<td>test OPERAND1, OPERAND2  <td>OPERAND1, OPERAND2을 bit and 연산을 이용해 비교. <br />결과값 저장 안됨.<br />and 연산 결과가 0이면 ZF 1로 세팅<tr><td>jmp<td>jmp OPERAND<td>OPERAND로 이동(jump)<tr><td>je<td>je OPERAND<td>cmp A, B에서 A == B일때 jmp.<tr><td>jne<td>jne OPERAND<td>cmp A, B에서 A != B일때 jmp.<tr><td>ja<td>ja OPERAND<td>cmp A, B에서 A &gt; B일때 jmp.<tr><td>jb<td>jb OPERAN<td>cmp A, B에서 A &lt; B일때 jmp.<tr><td>jae<td>jae OPERAND<td>cmp A, B에서 A ≥ B일때 jmp.<tr><td>jbe<td>jbe OPERAND<td>cmp A, B에서 A ≤ B일때 jmp.<tr><td>jz<td>jz OPERAND<td>ZF가 1로 세팅 되었을 때 jmp.<tr><td>jnz<td>jnz OPERAND<td>ZF가 0으로 세팅 되었을 때 jmp.<tr><td>push<td>push OPERAND<td>OPERAND 의 값을 메모리 스택에 푸쉬<tr><td>pop<td>pop OPERAND<td>OPERAND에 스택의 값을 가져오고 대입.<br />이후 STACK POINTER는 증가(스택 영역 크기 감소)<tr><td>mov<td>mov OPERAND1, OPERAND2                                  <td>OPERAND1에 OPERAND2의 값을 대입.<tr><td>lea<td>lea OPERAND1, OPERAND2  <td>OPERAND1에 OPERAND2의 주소를 대입.<tr><td>inc<td>inc OPERAND  <td>OPERAND의 값을 1 증가<tr><td>dec<td>dec OPERAND<td>OPERAND의 값을 1 감소<tr><td>add<td>add OPERAND1, OPERAND2  <td>OPERAND1 + OPERAND2 결과값을 OPERAND1에 저장<tr><td>sub<td>sub OPERAND1, OPERAND2   <td>OPERAND1 - OPERAND2 결과값을 OPERAND1에 저장<tr><td>div<td>div OPERAND1, OPERAND2  <td>OPERAND1 / OPERAND2 결과값을 OPERAND1에 저장(몫).<br />나머지는 64bit기준 rdx에 저장.<tr><td>imul<td>imul OPERAND1, OPERAND2  <td>OPERAND1 * OPERAND2 결과값을 OPERAND1에 저장<tr><td>shr<td>shr OPERAND1, OPERAND2  <td>OPERAND1의 값을 OPERAND2의 값만큼 오른쪽 비트 쉬프트.<tr><td>shl<td>shl OPERAND1, OPERAND2  <td>OPERAND1의 값을 OPERAND2의 값만큼 왼쪽 비트 쉬프트.<tr><td>int 0x80(32bit)<td>int 0x80<td>eax에 저장되어 있는 값을 기준으로, system call 호출<tr><td>syscall(64bit)<td>syscall<td>rax에 저장되어 있는 값을 기준으로, system call 호출</table></div><h3 id="assembly-코드해석"> <a href="#assembly-코드해석" class="anchor-heading" aria-labelledby="assembly-코드해석"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Assembly 코드해석</h3><p><code class="language-plaintext highlighter-rouge">section .data welcome db "Hello, Wolrd!"</code></p><p>해당 코드는 data 섹션을 정의하고, welcome이라는 변수 명에 byte 데이터로 “Hello, World!” 문자열을 저장한다.</p><p><code class="language-plaintext highlighter-rouge">section .text global _start</code></p><p>해당 라인에선, C에서의 main함수 처럼, 실제 프로그램의 시작 부분인 _start 프로시저를 명시한다.</p><p><code class="language-plaintext highlighter-rouge">_start:</code> 해당 부분에선 _start 프로시저의 코드가 정의된다.</p><p><code class="language-plaintext highlighter-rouge">mov rax, 1; sys_write</code> (;이후 부분은 주석) rax에 출력을 위한 syscall인 1을 저장한다. (linux syscall table 참조)</p><p><code class="language-plaintext highlighter-rouge">mov rdi, 1; stdout</code> <code class="language-plaintext highlighter-rouge">mov rsi, welcome; buf</code> <code class="language-plaintext highlighter-rouge">mov rdx, 0xd; message length</code> <code class="language-plaintext highlighter-rouge">syscall; calling sys_write</code></p><p>위 라인은 sys_write에 들어갈 인자들을 세팅한다. C 의 write(1, welcome, 0xd)와 동일하다고 보면 된다.</p><p><code class="language-plaintext highlighter-rouge">mov rax, 0x3c; sys_exit</code> mov rdi, 0x0; error_code syscall; calling sys_exit with error_code`</p><p>위 라인은 sys_exit를 호출하여 프로그램의 정상적인 종료를 진행하는 부분이다, C의 exit(0)와 동일하다고 보면 된다.</p><p>해당 코드를 위처럼 따라가면서 분석을 진행했다면, 실행 결과는 화면에 <code class="language-plaintext highlighter-rouge">Hello, World!</code>가 출력될 것이며, 프로그램의 종료 코드는 0임을 짐작 할 수 있다.</p><p>이처럼 직접 코드를 실행해가면서 분석하는 것을 <code class="language-plaintext highlighter-rouge">정적 분석</code>이라고 한다.</p><p>위의 정적 분석 결과를 우리가 훨씬 쉽게 읽을 수 있는 C코드로 변환하게 되면 다음처럼 될 것이다.(소스 코드 복원)</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"Hello World!"</span><span class="p">.</span> <span class="mh">0xd</span><span class="p">);</span>
	<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="동적분석"> <a href="#동적분석" class="anchor-heading" aria-labelledby="동적분석"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 동적분석</h3><p>지금은 툴 설명을 안했기 때문에, 읽어가면서 따라하면 된다. (pwndbg 사용, WSL 환경에서 진행하였다.)</p><ul><li>컴파일</ul><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nasm <span class="nt">-f</span> elf64 HelloWorld_64bit.s <span class="o">&amp;&amp;</span> ld <span class="nt">-o</span> HelloWorld_64bit HelloWorld_64bit.o
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nasm <span class="nt">-f</span> elf32 HelloWorld_32bit.s <span class="o">&amp;&amp;</span> ld <span class="nt">-m</span> elf_i386 <span class="nt">-o</span> HelloWorld_32bit HelloWorld_32bit.o
</code></pre></div></div><p>gdb 실행 <code class="language-plaintext highlighter-rouge">gdb ./HelloWorld_64bit</code></p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg1.png" alt="image" /></p><p><code class="language-plaintext highlighter-rouge">disass _start</code>명령어를 통해, 작성한 _start 프로시저의 디스어셈블 코드를 확인 할 수 있다.</p><p>n(next)명령어를 통해, 코드를 한줄 한줄 실행해보자.</p><p><code class="language-plaintext highlighter-rouge">pwndbg&gt; b _start</code> → break point를 _start 프로시저에 걸어보자.</p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg2.png" alt="image" /></p><p>이후, r(run)명령어로 프로그램을 실행하면, 해당 프로시저 진입에서 멈추는 것을 확인할 수 있다.</p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg3.png" alt="image" /></p><p>n명령어로, 단계별 실행결과를 바로바로 확인할 수 있다.</p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg4.png" alt="image" /></p><p>sys_write까지 실행했을 때, welcome 변수의 위치(주소)와 값을 확인 할 수 있으며, sys_write에 들어가는 인자들의 역할과 값을 확인할수 있다.</p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg5.png" alt="image" /></p><p><code class="language-plaintext highlighter-rouge">x/s &lt;address&gt;</code>를 통해, 해당 주소에 담긴 값을 문자열로 출력할 수 있다.</p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg6.png" alt="image" /></p><p><strong><code class="language-plaintext highlighter-rouge">[Image - sys_wrtie 실행]</code></strong></p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg7.png" alt="image" /></p><p>간단한 Hello, World 출력 프로그램을 (64bit 기준) 디버깅을 완료하였다.</p><p>이처럼 코드를 직접 한단계씩 실행해 가면서 분석해가는 과정을 <code class="language-plaintext highlighter-rouge">동적 분석</code>이라고 한다.</p><p>예제의 <code class="language-plaintext highlighter-rouge">32bit assembly</code>코드는 직접 따라 해보면서 Assembly를 학습하길 바란다..</p><h3 id="메모리-구조"> <a href="#메모리-구조" class="anchor-heading" aria-labelledby="메모리-구조"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 메모리 구조</h3><h3 id="함수-호출-규약"> <a href="#함수-호출-규약" class="anchor-heading" aria-labelledby="함수-호출-규약"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 함수 호출 규약</h3><h1 id="챕터-2-리버싱-찍먹하기"> <a href="#챕터-2-리버싱-찍먹하기" class="anchor-heading" aria-labelledby="챕터-2-리버싱-찍먹하기"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 챕터 2. 리버싱 찍먹하기</h1><h2 id="2-0-리버싱-툴---환경-구축하기"> <a href="#2-0-리버싱-툴---환경-구축하기" class="anchor-heading" aria-labelledby="2-0-리버싱-툴---환경-구축하기"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-0. 리버싱 툴 - 환경 구축하기</h2><details> <summary>동적 분석 툴 (디버깅)</summary><div><p><br /></p><h3 id="pwndbg-"> <a href="#pwndbg-" class="anchor-heading" aria-labelledby="pwndbg-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> pwndbg 구축</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#/bin/bash</span>
<span class="c">#setup.sh</span>

git clone https://github.com/pwndbg/pwndbg.git
<span class="nb">cd </span>pwndbg <span class="o">&amp;&amp;</span> ./setup.sh
</code></pre></div></div><p><strong><code class="language-plaintext highlighter-rouge">[Code - setup.sh]</code></strong> <br /> <a href="https://github.com/neko-hat/The-guide-for-ctf-reversing-beginners/blob/main/src/setup.sh"><code class="language-plaintext highlighter-rouge">setup.sh</code></a></p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg8.png" alt="image" /></p><p><strong><code class="language-plaintext highlighter-rouge">[Image - setup.sh execution]</code></strong></p><p>해당 쉘 스크립트를 위처럼 실행하면, 위의 사진처럼 화면이 나오면서 설치가 진행된다.</p><p><img src="/assets/images/guide-for-reversing-image/HelloPwndbg9.png" alt="image" /></p><p>이후, <code class="language-plaintext highlighter-rouge">gdb</code>명령어를 통해, <code class="language-plaintext highlighter-rouge">pwndbg&gt;</code>가 나오면 설치가 완료된 것이다.</p><p>아래는, <code class="language-plaintext highlighter-rouge">자주 사용하는 gdb 명령어</code>이다.</p><div class="table-wrapper"><table><thead><tr><th>command<th>Detail<tbody><tr><td>b(break) (*)address / function name<td>해당 address, function name에 break point 생성<tr><td>r(run)<td>program 실행<br />(실행중 break point를 만나면 해당 point에서 멈춤)<tr><td>c(conitnue)<td>program 실행 이후, break point까지 실행<tr><td>n(next)<td>step over.<br />한단계씩 코드를 실행하지만, 함수 내부로 들어가지 않음<tr><td>s(step into)<td>step into.<br />한단계씩 코드를 실행하며, 함수 내부로 들어간다.<tr><td>p/[type] (*)[value]<td>[value]를 [type]에 맞게 출력.<br />type 종류<br />1. s → string<br />2. x → hex<br />3. d → digit<br />4. u → unsigned<br />5. c → char<tr><td>x/(count)[type]w [address]<td>4바이트씩, [address]에 저장된 값을 tyoe에 맞게 출력<tr><td>x/(count)[type]g [address]<td>8바이트씩, [address]에 저장된 값을 tyoe에 맞게 출력<tr><td>vmmap (address)<td>전체 메모리 멥 출력.<br />(address)가 속한 메모리 멥 출력<tr><td>pd<td>program이 동작중일 때, 해당 부분의 일부분 disassembly 코드 출력.<tr><td>disass (*)address / function name<td>address, function name의 전체 disassembly 코드 출력.<tr><td>start<td>프로그램 시작점 (start)도달<tr><td>main<td>main 함수로 도달<tr><td>info reg<td>현재 전체 register 상태 출력<tr><td>stack<td>rsp 기준으로 stack 영역 출력</table></div><h3 id="radare2-"> <a href="#radare2-" class="anchor-heading" aria-labelledby="radare2-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> radare2 설치</h3><p><code class="language-plaintext highlighter-rouge">pwndbg(gdb)와, radare2는 취향 차이</code>이니, 적절한 툴을 고르면 된다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get <span class="nb">install </span>radare2
</code></pre></div></div><p><strong><code class="language-plaintext highlighter-rouge">[Code - radare2 install command]</code></strong></p><h3 id="x64-dbg-"> <a href="#x64-dbg-" class="anchor-heading" aria-labelledby="x64-dbg-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> x64 dbg 설치</h3></div></details> <details> <summary>정적 분석 툴(디컴파일러)</summary><div><p><br /></p><h3 id="ida-"> <a href="#ida-" class="anchor-heading" aria-labelledby="ida-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IDA 설치</h3><h3 id="ghidra-"> <a href="#ghidra-" class="anchor-heading" aria-labelledby="ghidra-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ghidra 설치</h3><h3 id="binary-ninja-"> <a href="#binary-ninja-" class="anchor-heading" aria-labelledby="binary-ninja-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Binary Ninja 설치</h3></div></details><h2 id="2-1-c-hello-world-pe-file로-리버싱-입문하기windows"> <a href="#2-1-c-hello-world-pe-file로-리버싱-입문하기windows" class="anchor-heading" aria-labelledby="2-1-c-hello-world-pe-file로-리버싱-입문하기windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-1. C Hello, World PE File로 리버싱 입문하기(Windows)</h2><h2 id="2-2-c-hello-world-elf-file로-리버싱-입문하기linux"> <a href="#2-2-c-hello-world-elf-file로-리버싱-입문하기linux" class="anchor-heading" aria-labelledby="2-2-c-hello-world-elf-file로-리버싱-입문하기linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-2. C Hello, World ELF File로 리버싱 입문하기(Linux)</h2><h2 id="2-3-abexcm1으로-pe-file-리버싱-시작하기windows"> <a href="#2-3-abexcm1으로-pe-file-리버싱-시작하기windows" class="anchor-heading" aria-labelledby="2-3-abexcm1으로-pe-file-리버싱-시작하기windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-3. Abexcm1으로 PE File 리버싱 시작하기(Windows)</h2><hr><div class="profiles"><div class="about_h2_container"><h2> <a href="#2-3-abexcm1으로-pe-file-리버싱-시작하기windows" class="anchor-heading" aria-labelledby="2-3-abexcm1으로-pe-file-리버싱-시작하기windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> About</h2></div><div class="about-profile"> <img class="neko_hat" src="/assets/images/neko_hat.png" /><div class="profile-info"><p>Reverser & Pwner</p></div></div></div><hr> <script src="https://giscus.app/client.js" data-repo="neko-hat/neko-hat.github.io" data-repo-id="R_kgDOJOrl5w" data-category="Comments" data-category-id="DIC_kwDOJOrl584CWfeC" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="dark" data-lang="ko" data-loading="lazy" crossorigin="anonymous" async> </script><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Patrick Marsceill. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/tree/main/LICENSE.txt">MIT license.</a> <a href="https://www.netlify.com/">This site is powered by Netlify.</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/neko-hat/neko-hat.github.io/tree/main/docs/CTF 리버싱 입문자를 위한 가이드.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div><script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
